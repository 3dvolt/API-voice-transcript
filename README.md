# API Documentation for Transcription Summary and Interaction

This API provides functionalities to fetch summaries and ask questions about transcriptions, powered by AI-generated content. Below is a detailed explanation of the API endpoints and how they work.

---

## **Setup Instructions**

### Prerequisites
1. **Node.js**: Make sure you have Node.js installed on your system.
2. **Dependencies**: Ensure the required dependencies are installed:
    - `express`
    - `multer`
    - `sequelize` (for database interactions)
    - Any custom utilities (e.g., `calculateDuration`, `promptBuilder`, etc.)
3. **Database Models**:
    - `Transcription`: Stores transcription data.
    - `Ai`: Stores AI-generated responses.
    - `Summary`: Stores generated summaries.

### Installation
1. Clone the repository.
2. Install dependencies using:
   ```bash
   npm install
   ```
3. Set up your database and models.
4. Start the server:
   ```bash
   node server.js
   ```

---

## **API Endpoints**

### 1. **Generate a Summary**
**Endpoint**: `/summary/:id`  
**Method**: `POST`  
**Description**: Fetches a transcription by ID, processes the AI-generated response, and creates a summary.

#### Request Parameters:
- **Path Parameter**:
    - `id`: The ID of the transcription record.

#### Request Example:
```bash
POST /summary/123
```

#### Response:
- **200 OK**: Returns the summary generated by the AI.
- **404 Not Found**: If the transcription or its AI details are not found.
- **500 Internal Server Error**: For server-side errors.

#### Response Example:
```json
{
  "summary": "This is a concise summary of the transcription content."
}
```

#### Implementation Details:
1. Fetch the transcription record from the database.
2. Join the `Transcription` with its associated `Ai` details using Sequelize.
3. Parse the AI response JSON to extract the content.
4. Use `getSummaryOPENAI()` to process the content and generate a summary.
5. Save the summary in the `Summary` table.

---

### 2. **Ask Questions about a Summary**
**Endpoint**: `/ask/summary/:id`  
**Method**: `POST`  
**Description**: Fetches a transcription by ID and allows users to ask questions based on the AI-generated response.

#### Request Parameters:
- **Path Parameter**:
    - `id`: The ID of the transcription record.
- **Body**:
    - `question` (string): The question you want to ask about the transcription's content.

#### Request Example:
```bash
POST /ask/summary/123
Content-Type: application/json

{
  "question": "What are the key points discussed?"
}
```

#### Response:
- **200 OK**: Returns the answer to the provided question.
- **404 Not Found**: If the transcription or its AI details are not found.
- **500 Internal Server Error**: For server-side errors.

#### Response Example:
```json
{
  "answer": "The key points include project deadlines and deliverables."
}
```

#### Implementation Details:
1. Fetch the transcription record by ID and join with `Ai` details.
2. Parse the AI response JSON to extract the content.
3. Use `asktoAIOPENAI()` to process the question and fetch the answer.
4. Return the response to the client.

---

## **Key Components**

### Middleware
- **`authenticateToken`**: Ensure secure access to the endpoints .

### Utilities
- **`getSummaryOPENAI()`**: Calls an AI service to generate summaries.
- **`asktoAIOPENAI()`**: Processes questions and generates answers using AI.

---

## **Error Handling**
- Logs detailed error messages to the server console for debugging.
- Provides client-friendly error messages in the JSON response.

---

## **Example Database Models**

### Transcription Model
Stores transcription details.
```javascript
{
  id: 123,
  content: "Audio transcription text...",
  AiDetails: { /* associated AI response */ }
}
```

### AI Model
Stores AI-generated content.
```javascript
{
  id: 456,
  AIresponse: "{\"text\":\"Detailed content analyzed by AI...\"}"
}
```

### Summary Model
Stores generated summaries.
```javascript
{
  id: 789,
  aiId: 123,
  AIresponse: "{\"summary\":\"This is a concise summary...\"}"
}
```

---

## **Usage Notes**
- Ensure proper database schema setup with relationships between `Transcription`, `Ai`, and `Summary`.
- AI services (e.g., OpenAI) should have valid API keys and configurations.
- Use authentication middleware (`authenticateToken`) to secure endpoints.

---

## **Future Enhancements**
- Add pagination for summaries and questions.
- Implement caching for frequently accessed data.
- Improve error messages and logging.

---
